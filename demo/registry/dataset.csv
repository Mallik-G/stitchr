id,object_ref,format,storage_type,mode,container,object_type,object_name,query,partition_key,number_partitions,priority_level,dataset_state_id,schema_id,data_source_id,data_destination_id
1,"postgresql_1_catalog_page","postgresql","database","base","public","table","catalog_page","public.catalog_page",,1,1,14,2,1,0
2,"postgresql_1_customer","postgresql","database","base","public","table","customer","public.customer",,1,1,14,5,1,0
3,"postgresql_1_customer_address","postgresql","database","base","public","table","customer_address","public.customer_address",,1,1,14,6,1,0
4,"postgresql_1_customer_demographics","postgresql","database","base","public","table","customer_demographics","public.customer_demographics",,1,1,14,7,1,0
5,"postgresql_1_date_dim","postgresql","database","base","public","table","date_dim","public.date_dim",,1,1,14,8,1,0
6,"postgresql_1_dbgen_version","postgresql","database","base","public","table","dbgen_version","public.dbgen_version",,1,1,14,9,1,0
7,"postgresql_1_household_demographics","postgresql","database","base","public","table","household_demographics","public.household_demographics",,1,1,14,10,1,0
8,"postgresql_1_income_band","postgresql","database","base","public","table","income_band","public.income_band",,1,1,14,11,1,0
9,"postgresql_1_item","postgresql","database","base","public","table","item","public.item",,1,1,14,13,1,0
10,"postgresql_1_promotion","postgresql","database","base","public","table","promotion","public.promotion",,1,1,14,14,1,0
11,"postgresql_1_time_dim","postgresql","database","base","public","table","time_dim","public.time_dim",,1,1,14,20,1,0
12,"postgresql_1_warehouse","postgresql","database","base","public","table","warehouse","public.warehouse",,1,1,14,21,1,0
13,"postgresql_1_web_page","postgresql","database","base","public","table","web_page","public.web_page",,1,1,14,22,1,0
14,"postgresql_1_web_site","postgresql","database","base","public","table","web_site","public.web_site",,1,1,14,25,1,0
15,"postgresql_1_catalog_returns","postgresql","database","base","public","table","catalog_returns","public.catalog_returns",,1,1,14,3,1,0
16,"postgresql_1_catalog_sales","postgresql","database","base","public","table","catalog_sales","public.catalog_sales",,1,1,14,4,1,0
17,"postgresql_1_inventory","postgresql","database","base","public","table","inventory","public.inventory",,1,1,14,12,1,0
18,"postgresql_1_store_sales","postgresql","database","base","public","table","store_sales","public.store_sales",,1,1,14,19,1,0
19,"postgresql_1_web_returns","postgresql","database","base","public","table","web_returns","public.web_returns",,1,1,14,23,1,0
20,"postgresql_1_call_center","postgresql","database","base","public","table","call_center","public.call_center",,1,1,14,1,1,0
21,"postgresql_1_reason","postgresql","database","base","public","table","reason","public.reason",,1,1,14,15,1,0
22,"postgresql_1_web_sales","postgresql","database","base","public","table","web_sales","public.web_sales","ws_item_sk",4,1,14,24,1,0
23,"postgresql_1_ship_mode","postgresql","database","base","public","table","ship_mode","public.ship_mode",,1,1,14,16,1,0
24,"postgresql_1_store","postgresql","database","base","public","table","store","public.store",,1,1,14,17,1,0
25,"postgresql_1_store_returns","postgresql","database","base","public","table","store_returns","public.store_returns",,1,1,14,18,1,0
26,"catalog_page","pipeDelimited","file","base","demo/data/tpcds","file","catalog_page","catalog_page.dat",,1,1,12,2,3,0
27,"customer","pipeDelimited","file","base","demo/data/tpcds","file","customer","customer.dat",,1,1,12,5,3,0
28,"customer_address","pipeDelimited","file","base","demo/data/tpcds","file","customer_address","customer_address.dat",,1,1,12,6,3,0
29,"customer_demographics","pipeDelimited","file","base","demo/data/tpcds","file","customer_demographics","customer_demographics.dat",,1,1,12,7,3,0
30,"date_dim","pipeDelimited","file","base","demo/data/tpcds","file","date_dim","date_dim.dat",,1,1,12,8,3,0
31,"dbgen_version","pipeDelimited","file","base","demo/data/tpcds","file","dbgen_version","dbgen_version.dat",,1,1,12,9,3,0
32,"household_demographics","pipeDelimited","file","base","demo/data/tpcds","file","household_demographics","household_demographics.dat",,1,1,12,10,3,0
33,"income_band","pipeDelimited","file","base","demo/data/tpcds","file","income_band","income_band.dat",,1,1,12,11,3,0
34,"item","pipeDelimited","file","base","demo/data/tpcds","file","item","item.dat",,1,1,12,13,3,0
35,"promotion","pipeDelimited","file","base","demo/data/tpcds","file","promotion","promotion.dat",,1,1,12,14,3,0
36,"time_dim","pipeDelimited","file","base","demo/data/tpcds","file","time_dim","time_dim.dat",,1,1,12,20,3,0
37,"warehouse","pipeDelimited","file","base","demo/data/tpcds","file","warehouse","warehouse.dat",,1,1,12,21,3,0
38,"web_page","pipeDelimited","file","base","demo/data/tpcds","file","web_page","web_page.dat",,1,1,12,22,3,0
39,"web_site","pipeDelimited","file","base","demo/data/tpcds","file","web_site","web_site.dat",,1,1,12,25,3,0
40,"catalog_returns","pipeDelimited","file","base","demo/data/tpcds","file","catalog_returns","catalog_returns.dat",,1,1,12,3,3,0
41,"catalog_sales","pipeDelimited","file","base","demo/data/tpcds","file","catalog_sales","catalog_sales.dat",,1,1,12,4,3,0
42,"inventory","pipeDelimited","file","base","demo/data/tpcds","file","inventory","inventory.dat",,1,1,12,12,3,0
43,"store_sales","pipeDelimited","file","base","demo/data/tpcds","file","store_sales","store_sales.dat",,1,1,12,19,3,0
44,"web_returns","pipeDelimited","file","base","demo/data/tpcds","file","web_returns","web_returns.dat",,1,1,12,23,3,0
45,"call_center","pipeDelimited","file","base","demo/data/tpcds","file","call_center","call_center.dat",,1,1,12,1,3,0
46,"reason","pipeDelimited","file","base","demo/data/tpcds","file","reason","reason.dat",,1,1,12,15,3,0
47,"web_sales","pipeDelimited","file","base","demo/data/tpcds","file","web_sales","web_sales.dat",,1,1,12,24,3,0
48,"ship_mode","pipeDelimited","file","base","demo/data/tpcds","file","ship_mode","ship_mode.dat",,1,1,12,16,3,0
49,"store","pipeDelimited","file","base","demo/data/tpcds","file","store","store.dat",,1,1,12,17,3,0
50,"store_returns","pipeDelimited","file","base","demo/data/tpcds","file","store_returns","store_returns.dat",,1,1,12,18,3,0
51,"q2","parquet","file","derived","demo/data/tpcds","file","q2","select d_week_seq1
       ,round(sun_sales1/sun_sales2,2) sun
       ,round(mon_sales1/mon_sales2,2) mon
       ,round(tue_sales1/tue_sales2,2) tue
       ,round(wed_sales1/wed_sales2,2) wed
       ,round(thu_sales1/thu_sales2,2) thu
       ,round(fri_sales1/fri_sales2,2) fri
       ,round(sat_sales1/sat_sales2,2) sat
 from
 (select wswscs.d_week_seq d_week_seq1
        ,sun_sales sun_sales1
        ,mon_sales mon_sales1
        ,tue_sales tue_sales1
        ,wed_sales wed_sales1
        ,thu_sales thu_sales1
        ,fri_sales fri_sales1
        ,sat_sales sat_sales1
  from wswscs,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998) y,
 (select wswscs.d_week_seq d_week_seq2
        ,sun_sales sun_sales2
        ,mon_sales mon_sales2
        ,tue_sales tue_sales2
        ,wed_sales wed_sales2
        ,thu_sales thu_sales2
        ,fri_sales fri_sales2
        ,sat_sales sat_sales2
  from wswscs
      ,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998+1) z
 where d_week_seq1=d_week_seq2-53
 order by d_week_seq1",,1,1,4,-1,3,0
52,"wswscs","parquet","file","derived","demo/data/tpcds","file","wswscs","select d_week_seq,
        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales
 from wscs
     ,date_dim
 where d_date_sk = sold_date_sk
 group by d_week_seq",,1,1,4,-1,3,0
53,"wscs","parquet","file","derived","demo/data/tpcds","file","wscs","select sold_date_sk
        ,sales_price
  from (select ws_sold_date_sk sold_date_sk
              ,ws_ext_sales_price sales_price
        from web_sales
        union all
        select cs_sold_date_sk sold_date_sk
              ,cs_ext_sales_price sales_price
        from catalog_sales) v",,1,1,4,-1,3,0
54,"year_total","parquet","file","derived","demo/data/tpcds","file","year_total","select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total
       ,'c' sale_type
 from customer
     ,catalog_sales
     ,date_dim
 where c_customer_sk = cs_bill_customer_sk
   and cs_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year",,1,1,4,-1,3,0
55,"q4","parquet","file","derived","demo/data/tpcds","file","q4","select
                  t_s_secyear.customer_id
                 ,t_s_secyear.customer_first_name
                 ,t_s_secyear.customer_last_name
                 ,t_s_secyear.customer_birth_country
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_c_firstyear
     ,year_total t_c_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
   and t_s_firstyear.customer_id = t_c_secyear.customer_id
   and t_s_firstyear.customer_id = t_c_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_secyear.customer_id
   and t_s_firstyear.sale_type = 's'
   and t_c_firstyear.sale_type = 'c'
   and t_w_firstyear.sale_type = 'w'
   and t_s_secyear.sale_type = 's'
   and t_c_secyear.sale_type = 'c'
   and t_w_secyear.sale_type = 'w'
   and t_s_firstyear.dyear =  1999
   and t_s_secyear.dyear = 1999+1
   and t_c_firstyear.dyear =  1999
   and t_c_secyear.dyear =  1999+1
   and t_w_firstyear.dyear = 1999
   and t_w_secyear.dyear = 1999+1
   and t_s_firstyear.year_total > 0
   and t_c_firstyear.year_total > 0
   and t_w_firstyear.year_total > 0
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
 order by t_s_secyear.customer_id
         ,t_s_secyear.customer_first_name
         ,t_s_secyear.customer_last_name
         ,t_s_secyear.customer_birth_country",,1,1,4,-1,3,0
56,"postgresql_1_wscs1","postgresql","database","derived","public","view","wscs1","select sold_date_sk
        ,sales_price
  from (select ws_sold_date_sk sold_date_sk
              ,ws_ext_sales_price sales_price
        from web_sales
        union all
        select cs_sold_date_sk sold_date_sk
              ,cs_ext_sales_price sales_price
        from catalog_sales) v",,1,1,14,-1,1,0
57,"postgresql_1_q21","postgresql","database","derived","public","view","q21","select d_week_seq1
       ,round(sun_sales1/sun_sales2,2) sun
       ,round(mon_sales1/mon_sales2,2) mon
       ,round(tue_sales1/tue_sales2,2) tue
       ,round(wed_sales1/wed_sales2,2) wed
       ,round(thu_sales1/thu_sales2,2) thu
       ,round(fri_sales1/fri_sales2,2) fri
       ,round(sat_sales1/sat_sales2,2) sat
 from
 (select wswscs.d_week_seq d_week_seq1
        ,sun_sales sun_sales1
        ,mon_sales mon_sales1
        ,tue_sales tue_sales1
        ,wed_sales wed_sales1
        ,thu_sales thu_sales1
        ,fri_sales fri_sales1
        ,sat_sales sat_sales1
  from wswscs1 as wswscs,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998) y,
 (select wswscs.d_week_seq d_week_seq2
        ,sun_sales sun_sales2
        ,mon_sales mon_sales2
        ,tue_sales tue_sales2
        ,wed_sales wed_sales2
        ,thu_sales thu_sales2
        ,fri_sales fri_sales2
        ,sat_sales sat_sales2
  from wswscs1 as wswscs
      ,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998+1) z
 where d_week_seq1=d_week_seq2-53
 order by d_week_seq1",,1,1,14,-1,1,0
58,"postgresql_1_wswscs1","postgresql","database","derived","public","view","wswscs1","select d_week_seq,
        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales
 from wscs1 as wscs
     ,date_dim
 where d_date_sk = sold_date_sk
 group by d_week_seq",,1,1,14,-1,1,0
59,"postgresql_3_web_sales_m","postgresql","database","base","public","table","web_sales_m","public.web_sales","ws_sold_date_sk",4,1,14,-1,3,0
